import{_ as W,l as Z,a as c,o as ee,C as te,g as y,q as o,u as t,v as s,t as h,h as U,w as i,n as ae,E as se,f as N,e as f,y as oe,ac as le,x as ne,ad as ce,ae as ie,af as re,ag as ue,ah as de,ai as fe,j as ve,ab as me}from"./index-Du4dCbfO.js";import{E as pe}from"./el-button-M656iEmA.js";import"./el-tooltip-l0sNRNKZ.js";import{E as _e}from"./el-popper-BdLD6iUU.js";import{E as ye}from"./el-input-number-HodOf3dq.js";import"./el-input-Bo7UyxaJ.js";import{a as S}from"./axios-BqNK95tu.js";import{a as he,d as ge}from"./vid-C-zc31tL.js";import{u as ke}from"./user-CW08ZWUW.js";import{E as r}from"./index-C1fdLA7_.js";import{E as xe}from"./constants-D2akMa4K.js";const be={class:"video"},we=["src"],Ce={key:1,style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"}},Re={key:2,class:"title"},Te={key:3,class:"iconbox"},Ee={key:4,class:"fontbar"},Fe={class:"btn"},ze={style:{display:"flex","align-items":"center"}},Ue={style:{"margin-left":"10px"}},Le={style:{display:"flex","align-items":"center"}},Ne={class:"gird"},Se={class:"back"},Ve={__name:"index",setup(qe){const V=ke();let q=String(V.info.id);const M=Z(),u=c(!1),v=c(),j=c(),g=c(!1),w=c(),k=c(),C=c(),m=c(!0),x=c(!0),n=c(null),p=c(0),b=c(0);function B(){n.value.requestFullscreen?n.value.requestFullscreen():n.value.webkitRequestFullscreen?n.value.webkitRequestFullscreen():n.value.msRequestFullscreen&&n.value.msRequestFullscreen()}function R(){return Math.floor(Math.random()*999)+100}function T(){if(u.value)return r.warning("😅别急...");g.value=!1,u.value=!0,S("/xiarou/api/meinv?type=json",{method:"get",timeout:3e4}).then(e=>{p.value=0,b.value=0,w.value=R(),k.value=R(),C.value=R(),v.value=e.data.data,x.value=!0,u.value=!1,setTimeout(()=>{n.value.addEventListener("loadedmetadata",()=>{b.value=n.value.duration})},0)}).catch(e=>{r.error("🤬网络出问题了！"+e),u.value=!1})}function E(){x.value?(n.value.pause(),x.value=!1):(n.value.play(),x.value=!0)}const Y=()=>{p.value=n.value.currentTime},O=e=>{const a=parseFloat(e);n.value.currentTime=a},L=e=>{const a=Math.floor(e/60),d=Math.floor(e%60);return`${a.toString().padStart(2,"0")}:${d.toString().padStart(2,"0")}`};function D(){M.go(-1)}function I(){T()}function X(){r.success("功能开发中！")}function $(){const e=v.value;navigator.clipboard.writeText(e).then(a=>{r.success("链接复制成功！")}).catch(a=>{r.error(a)})}async function G(){let e=v.value;try{const d=await(await fetch(e)).blob(),l=document.createElement("a");l.href=window.URL.createObjectURL(d),l.download=e,l.click(),window.URL.revokeObjectURL(l.href)}catch(a){console.error("下载文件时出错:",a)}}async function P(){let e=v.value;S(`/xiarou/api/gif?url=${e}`,{method:"get",timeout:3e4}).then(async a=>{try{const l=await(await fetch(a.data.data)).blob(),_=document.createElement("a");_.href=window.URL.createObjectURL(l),_.download=a.data.data,_.click(),window.URL.revokeObjectURL(_.href)}catch(d){console.error("下载文件时出错:",d)}}).catch(a=>{r.error("🤬网络出问题了！"+a)})}async function A(){if(!m.value)return r.warning("处理中请稍后");m.value=!1,g.value?ge({url:v.value}).then(e=>{e.status==200?(k.value-=1,g.value=!1,m.value=!0):(r.success("取消失败！"),m.value=!0)}):he({createBy:q,url:v.value,comment:w.value,collect:k.value+1,transmit:C.value}).then(e=>{e.status==200?(k.value+=1,g.value=!0,r.success("收藏成功！"),m.value=!0):(r.success("收藏失败！"),m.value=!0)})}const F=c({clientX:0,clientY:0});function H(e){const a=e.changedTouches[0].clientY-F.value.clientY;(a>100||a<-100)&&T()}function J(e){F.value.clientX=e.changedTouches[0].clientX,F.value.clientY=e.changedTouches[0].clientY}return ee(()=>{T()}),(e,a)=>{const d=te("Loading"),l=xe,_=ye,z=_e,K=pe;return f(),y("div",{class:"seepage",onTouchstart:J,onTouchend:H},[o("div",be,[t(u)?(f(),y("div",Ce,[s(d)])):(f(),y("video",{key:0,onClick:E,ref_key:"videoRef",ref:n,src:t(v),crossOrign:"anonymous",autoplay:"",playsinline:!0,"x5-playsinline":"true",mediatype:"video",crossorigin:"anonymous",onTimeupdate:Y,loop:""},null,40,we)),t(u)?U("",!0):(f(),y("div",Re,h(t(j)),1)),t(u)?U("",!0):(f(),y("div",Te,[o("div",{class:"gird",onClick:X},[s(l,{style:{"font-size":"30px"}},{default:i(()=>[s(t(oe))]),_:1}),o("div",null,h(t(w)),1)]),o("div",{class:"gird",onClick:A},[s(l,{style:{"font-size":"30px"},class:ae({yello:t(g)})},{default:i(()=>[s(t(le))]),_:1},8,["class"]),o("div",null,h(t(k)),1)]),o("div",{class:"gird",onClick:$},[s(l,{style:{"font-size":"30px"}},{default:i(()=>[s(t(ne))]),_:1}),o("div",null,h(t(C)),1)])])),t(u)?U("",!0):(f(),y("div",Ee,[s(_,{class:"onlypc",step:.1,modelValue:t(p),"onUpdate:modelValue":a[0]||(a[0]=Q=>se(p)?p.value=Q:null),"show-tooltip":!1,style:{width:"100%"},min:0,max:t(b),onChange:O},null,8,["modelValue","max"]),o("div",Fe,[o("div",ze,[t(x)?(f(),N(l,{key:0,onClick:E,style:{"font-size":"18px"}},{default:i(()=>[s(t(ce))]),_:1})):(f(),N(l,{key:1,onClick:E,style:{"font-size":"18px"}},{default:i(()=>[s(t(ie))]),_:1})),o("div",Ue,h(L(t(p)))+" / "+h(L(t(b))),1)]),o("div",Le,[s(z,{class:"box-item",effect:"dark",content:"下载GIF",placement:"top"},{default:i(()=>[o("div",Ne,[s(l,{onClick:P,style:{"font-size":"18px"}},{default:i(()=>[s(t(re))]),_:1})])]),_:1}),s(z,{class:"box-item",effect:"dark",content:"下载MP4",placement:"top"},{default:i(()=>[o("div",{class:"gird",onClick:G},[s(l,{style:{"font-size":"18px"}},{default:i(()=>[s(t(ue))]),_:1})])]),_:1}),s(z,{class:"box-item",effect:"dark",content:"全屏",placement:"top"},{default:i(()=>[o("div",{class:"gird onlypc",onClick:B},[s(l,{style:{"font-size":"18px"}},{default:i(()=>[s(t(de))]),_:1})])]),_:1})])])]))]),a[2]||(a[2]=o("div",{class:"bgc"},null,-1)),o("div",{class:"next",onClick:I},[s(l,{style:{color:"#161823"}},{default:i(()=>[s(t(fe))]),_:1})]),o("div",Se,[s(K,{icon:t(me),color:"transparent",type:"primary",size:"default",onClick:D},{default:i(()=>a[1]||(a[1]=[ve("返回")])),_:1},8,["icon"])])],32)}}},Ae=W(Ve,[["__scopeId","data-v-f7e0b009"]]);export{Ae as default};
